---

copyright:
  years: 2017, 2020
lastupdated: "2020-02-25"

keywords: Key Protect CLI plug-in, CLI reference

subcollection: key-protect

---

{:shortdesc: .shortdesc}
{:screen: .screen}
{:pre: .pre}
{:table: .aria-labeledby="caption"}
{:external: target="_blank" .external}
{:codeblock: .codeblock}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:term: .term}

# {{site.data.keyword.keymanagementserviceshort}} CLI Reference
{: #cli-reference}

You can use {{site.data.keyword.keymanagementserviceshort}} CLI plug-in to manage keys in your instance of {{site.data.keyword.keymanagementserviceshort}}.
{:shortdesc}

To install the CLI plug-in, see [Setting up the CLI](/docs/key-protect?topic=key-protect-set-up-cli). 

When you log in to the [{{site.data.keyword.cloud_notm}} CLI](/docs/cli?topic=cloud-cli-getting-started){: external}, you're notified when updates are available. Be sure to keep your CLI up-to-date so that you can use the commands and flags that are available for the {{site.data.keyword.keymanagementserviceshort}} CLI plug-in.
{: tip}

## ibmcloud kp commands
{: #ibmcloud-kp-commands}

You can specify one of the following commands.

| Command                                       | Description                                                |
| --------------------------------------------- | ---------------------------------------------------------- |
| [kp key create](#kp-key-create)               | Create a key or import your own key                        |
| [kp key delete](#kp-key-delete)               | Delete a key permanently                                   |
| [kp key policies](#kp-key-policies)           | Retrieve list of policies associated with a key            |
| [kp key policy-update](#kp-key-policy-update) | Replace policy associated with a key                       |
| [kp key rotate](#kp-key-rotate)               | Rotate a root key                                          |
| [kp key show](#kp-key-show)                   | Retrieve a key                                             |
| [kp key unwrap](#kp-key-unwrap)               | Unwrap a data encryption key                               |
| [kp key wrap](#kp-key-wrap)                   | Wrap a data encryption key                                 |
| [kp keys](#kp-keys)                           | List the keys that are available in your service instance. |

{: caption="Table 1. Commands for managing encryption keys" caption-side="top"}
{: #table-1}
{: tab-title="Keys"}
{: class="comparison-tab-table"}
{: row-headers}

| Command                   | Description                                                |
| --------------------------| ---------------------------------------------------------- |
{: caption="Table 2. Command to list keys" caption-side="top"}
{: #table-2}
{: tab-title="List keys"}
{: class="comparison-tab-table"}
{: row-headers}

| Command                                                         | Description                                                                            |
| --------------------------------------------------------------- | -------------------------------------------------------------------------------------- |
| [kp import-token create](#kp-import-token-create)               | Create an import token                                                                 |
| [kp import-token show](#kp-import-token-show)                     | Retrieve an import token                                                               |
| [kp import-token nonce-encrypt](#kp-import-token-nonce-encrypt) | Encrypt the nonce that is generated by {{site.data.keyword.keymanagementserviceshort}} |
| [kp import-token key-encrypt](#kp-import-token-key-encrypt)     | Encrypt the key that you want to import to the service                                 |
{: caption="Table 3. Commands for managing import tokens" caption-side="top"}
{: #table-3}
{: tab-title="Import tokens"}
{: class="comparison-tab-table"}
{: row-headers}

## kp key create
{: #kp-key-create}

[Create a root key](/docs/key-protect?topic=key-protect-create-root-keys) in the {{site.data.keyword.keymanagementserviceshort}} service instance that you specify. 

```
ibmcloud kp key create KEY_NAME -i $INSTANCE_ID
                   [-k, --key-material KEY_MATERIAL] 
                   [-s, --standard-key]
                   [--output FORMAT]
```
{:pre}

### Required parameters
{: #key-create-req-params}

<dl>
    <dt><code>KEY_NAME</code></dt>
        <dd>A unique, human-readable alias to assign to your key.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #key-create-opt-params}

<dl>
    <dt><code>-k, --key-material</code></dt>
        <dd>The base64 encoded key material that you want to store and manage in the service. To import an existing key, provide a 256-bit key. To generate a new key, omit the <code>--key-material</code> parameter.</dd>
    <dt><code>-n, --encrypted-nonce</code></dt>
        <dd><p><b>Used with import tokens.</b> The encrypted nonce value that verifies your request to import a key to {{site.data.keyword.keymanagementserviceshort}}. This value must be encrypted by using the key material that you want to import to the service.</p>
        <p>To retrieve a nonce, use <code>ibmcloud kp import-token create</code>. Then, encrypt the value by running <code>ibmcloud kp import-token nonce-encrypt</code>.</p>
        </dd>
    <dt><code>-v, --iv</code></dt>
        <dd><b>Used with import tokens.</b> The initialization vector (IV) that is generated when you encrypt a nonce. The IV value is required to decrypt the encrypted nonce value that you provide when you make a key import request to the service.</p>
        <p>To generate an IV, encrypt the nonce by running <code>ibmcloud kp import-token nonce-encrypt</code>.</dd>
    <dt><code>-s, --standard-key</code></dt>
        <dd>Set the parameter only if you want to create a <a href="/docs/key-protect?topic=key-protect-envelope-encryption#key-types">standard key</a>. To create a root key, omit the <code>--standard-key</code> parameter.</dd>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

### Usage examples
{: #create-examples}

#### Create a key
{: #create-key-example} 

```sh
$ ibmcloud kp key create my-new-root-key -i $INSTANCE_ID
SUCCESS

Key ID                                 Key Name
3df42bc2-a991-41cb-acc2-3f9eab64a63f   my-new-root-key
```
{:screen}

#### Import a key that you generate on-premises
{: #import-key-example}

```sh
$ ibmcloud kp key create my-imported-root-key -i $INSTANCE_ID -k $KEY_MATERIAL
SUCCESS

Key ID                                 Key Name
3df42bc2-a991-41cb-acc2-3f9eab64a63f   my-imported-root-key
```
{:screen}

#### Import a key by using an import token
{: #import-key-with-import-token-example}

```sh
$ ibmcloud kp key create my-imported-root-key -i $INSTANCE_ID -k $ENCRYPTED_KEY -n $NONCE -iv $IV
SUCCESS

Key ID                                 Key Name
3df42bc2-a991-41cb-acc2-3f9eab64a63f   my-encrypted-root-key
```
{:screen}

See the [`ibmcloud kp import-token` subcommands](#kp-import-token-create) for information about using an import token to upload a key to {{site.data.keyword.keymanagementserviceshort}}.
{: tip}

## kp keys
{: #kp-list}

List the last 200 keys that are available in your {{site.data.keyword.keymanagementserviceshort}} service instance.

```
ibmcloud kp keys -i $INSTANCE_ID
```
{: pre}

```sh
$ ibmcloud kp keys -i $KP_INSTANCE_ID
Retrieving keys...

SUCCESS

Key ID                                 Key Name
3df42bc2-a991-41cb-acc2-3f9eab64a63f   sample-root-key
92e5fab3-00e8-40e9-8a2d-864de334b043   sample-imported-root-key
```
{: screen}

### Required parameters
{: #list-req-params}

<dl>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #list-opt-params}

<dl>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp key show
{: #kp-get}

Retrieve details about a key, such as the key metadata and key material.

If the key was designated as a root key, the system cannot return the key material for that key.

```
ibmcloud kp key show KEY_ID -i $INSTANCE_ID
```
{: pre}

```sh
$ ibmcloud kp key show 3df42bc2-a991-41cb-acc2-3f9eab64a63f -i $KP_INSTANCE_ID
Grabbing info for key id: 3df42bc2-a991-41cb-acc2-3f9eab64a63f...

SUCCESS

Key ID                                 Key Name          Description     Creation Date                   Expiration Date
3df42bc2-a991-41cb-acc2-3f9eab64a63f   sample-root-key   A sample key.   2019-04-02 16:42:47 +0000 UTC   Key does not expire
```
{:screen}

### Required parameters
{: #get-req-params}

<dl>
   <dt><code>KEY_ID</code></dt>
        <dd>The ID of the key that you want to retrieve. To retrieve a list of your available keys, run the <a href="#kp-list">kp keys</a> command.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #get-opt-params}

<dl>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp key wrap
{: #kp-key-wrap}

[Wrap a data encryption key](/docs/key-protect?topic=key-protect-wrap-keys) by using a root key that is stored in the {{site.data.keyword.keymanagementserviceshort}} service instance that you specify.

```
ibmcloud kp key wrap KEY_ID -i $INSTANCE_ID
                 [-p, --plaintext DATA_KEY] 
                 [-a, --aad ADDITIONAL_DATA]
```
{: pre}


### Required parameters
{: #wrap-req-params}

<dl>
    <dt><code>KEY_ID</code></dt>
        <dd>The ID of the root key that you want to use for wrapping.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #wrap-opt-params}

<dl>
    <dt><code>-a, --aad</code></dt>
        <dd>The additional authentication data (AAD) that is used to further secure a key. If provided on wrap must be provided on unwrap.</dd>
    <dt><code>-p, --plaintext</code></dt>
        <dd>The base64 encoded data encryption key (DEK) that you want to manage and protect. To import an existing key, provide a 256-bit key. To generate and wrap a new DEK, omit the <code>--plaintext</code> parameter.</dd>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp key unwrap
{: #kp-key-unwrap}

[Unwrap a data encryption key](/docs/key-protect?topic=key-protect-unwrap-keys) by using a root key that is stored in your {{site.data.keyword.keymanagementserviceshort}} service instance.

```
ibmcloud kp key unwrap KEY_ID -i $INSTANCE_ID 
                   CIPHERTEXT_FROM_WRAP
                   [-a, --aad ADDITIONAL_DATA, ..]
```
{: pre}

### Required parameters
{: #unwrap-req-params}

<dl>
    <dt><code>KEY_ID</code></dt>
        <dd>The ID of the root key that you used for the initial wrap request.</dd>
    <dt><code>CIPHERTEXT_FROM_WRAP</code></dt>
        <dd>The encrypted data key that was returned during the initial wrap operation.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #unwrap-opt-params}

<dl>
    <dt><code>-a, --aad</code></dt>
        <dd><p>The additional authentication data (AAD) that was used to further secure a key. You can provide up to 255 strings, each delimited by a comma. If you supplied AAD on wrap, you must specify the same AAD on unwrap.</p><p><b>Important:</b> The {{site.data.keyword.keymanagementserviceshort}} service does not save additional authentication data. If you supply AAD, save the data to a secure location to ensure that you can access and provide the same AAD during subsequent unwrap requests.</p></dd>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp key rotate 
{: #kp-key-rotate}

[Rotate a root key](/docs/key-protect?topic=key-protect-wrap-keys) that is stored in your {{site.data.keyword.keymanagementserviceshort}} service.

```
ibmcloud kp key rotate  KEY_ID -i $INSTANCE_ID
                 [-k, --key-material KEY_MATERIAL] 
```
{: pre}

```sh
$ ibmcloud kp key rotate  3df42bc2-a991-41cb-acc2-3f9eab64a63f -i $KP_INSTANCE_ID
Rotating root key...

SUCCESS
```
{:screen}

### Required parameters
{: #rotate-req-params}

<dl>
    <dt><code>KEY_ID</code></dt>
        <dd>The ID of the root key that you want to rotate.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #rotate-opt-params}

<dl>
    <dt><code>-k, --key-material</code></dt>
        <dd>The base64 encoded key material that you want to use for rotating an existing root key. To rotate a key that was initially imported into the service, provide a new 256-bit key. To rotate a key that was initially generated in {{site.data.keyword.keymanagementserviceshort}}, omit the <code>--key-material</code> parameter.</dd>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp key delete
{: #kp-delete}

[Delete a key](/docs/key-protect?topic=key-protect-delete-keys) that is stored in your {{site.data.keyword.keymanagementserviceshort}} service.

```
ibmcloud kp key delete KEY_ID -i $INSTANCE_ID
```
{: pre}

```sh
$ ibmcloud kp key delete 584fb0d9-dec2-47b8-bde5-50f05fd66261 -i $KP_INSTANCE_ID
Deleting key: 584fb0d9-dec2-47b8-bde5-50f05fd66261, from instance: 98d39ab8-cf44-4517-9583-2ad05c7e9bd5...

SUCCESS

Deleted Key
584fb0d9-dec2-47b8-bde5-50f05fd66261
```
{: screen}

### Required parameters
{: #delete-req-params}

<dl>
   <dt><code>KEY_ID</code></dt>
   <dd>The ID of the key that you want to delete. To retrieve a list of your available keys, run the <a href="#kp-list">kp keys</a> command.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

## kp key policy-update
{: #kp-policy-set}

Create or replace the policy that is associated with the root key that you specify.

```
ibmcloud kp key policy-update KEY_ID -i $INSTANCE_ID
                 --set-type POLICY_TYPE 
                 [--policy INTERVAL]
```
{: pre}

### Required parameters
{: #policy-set-req-params}

<dl>
   <dt><code>KEY_ID</code></dt>
        <dd>The ID of the key that you want to query. To retrieve a list of your available keys, run the <a href="#kp-list">kp keys</a> command.</dd>
   <dt><code>--set-type</code></dt>
        <dd>Specify the type of policy that you want to set. To set a rotation policy, use <code>--set-type rotation</code>.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #policy-set-opt-params}

<dl>
   <dt><code>-p, --policy</code></dt>
        <dd>Specify the rotation time interval (in months) for a key. The default value is 1.</dd>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp policy get
{: #kp-policy-get}

Retrieve details about a key policy, such as the key's automatic rotation interval.

```
ibmcloud kp policy get KEY_ID -i $INSTANCE_ID
```
{: pre}

### Required parameters
{: #policy-get-req-params}

<dl>
   <dt><code>KEY_ID</code></dt>
        <dd>The ID of the key that you want to query. To retrieve a list of your available keys, run the <a href="#kp-list">kp keys</a> command.</dd>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #policy-get-opt-params}

<dl>
    <dt><code>-o, --output</code></dt>
        <dd>Set the CLI output format. By default, all commands print in table format. To change the output format to JSON, use <code>--output json</code>.</dd>
</dl>

## kp import-token create
{: #kp-import-token-create}

[Create an import token](/docs/key-protect?topic=key-protect-create-import-tokens) in the {{site.data.keyword.keymanagementserviceshort}} service instance that you specify. 

```
ibmcloud kp import-token create -i $INSTANCE_ID
                   [-e, --expiration=TIME_IN_SECONDS] 
                   [-m, --max-retrievals=USE_COUNT]
```
{:pre}

```sh
$ ibmcloud kp import-token create -i $INSTANCE_ID --expiration=300 --max-retrievals=3
SUCCESS

Created                         Expires                         Max Retrievals   Remaining Retrievals
2019-08-05 19:56:11 +0000 UTC   2019-08-05 20:01:11 +0000 UTC   3                3
```
{:screen}

### Required parameters
{: #import-token-create-req-params}

<dl>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #import-token-create-opt-params}

<dl>
    <dt><code>-e, --expiration</code></dt>
        <dd><p>Specify an expiration time (in seconds) for an import token. This value determines how long the import token and its associated public key remain valid for operations.</p>
            <p>The minimum value is <code>300</code> seconds (5 minutes), and the maximum value is <code>86400</code> (24 hours). The default value is <code>600</code> (10 minutes).</p>
        </dd>
    <dt><code>-m, --max-retrievals</code></dt>
        <dd>Set the use count for the import token. This value determines the number of times that the import token can be retrieved within its expiration time before it is no longer accessible. The default value is <code>1</code>.</dd>
</dl>

## kp import-token show
{: #kp-import-token-show}

[Retrieve the import token](/docs/key-protect?topic=key-protect-create-import-tokens#retrieve-import-token-api) that is associated with your service instance. 

The import token contains a public encryption key and a nonce. Provide the retrieved public key and nonce as arguments for `ibmcloud kp import-token nonce-encrypt` and `ibmcloud kp import-token key-encrypt`.

```
ibmcloud kp import-token show -i $INSTANCE_ID
```
{:pre}

```sh
$ ibmcloud kp import-token show -i $INSTANCE_ID 
SUCCESS

{
	"nonce": "EE1sUNE4BZCTU3q/",
	"payload": "LS0tLS1CRUdJTiBQVUJMSUMgS0V..."
}
```
{:screen}

### Required parameters
{: #import-token-get-req-params}

<dl>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

## kp import-token nonce-encrypt
{: #kp-import-token-nonce-encrypt}

Encrypt the nonce that is distributed by {{site.data.keyword.keymanagementserviceshort}} with the key material that you want to import to the service. Then, provide the retrieved encrypted nonce and IV values when you run `ibmcloud kp key create` to import the key.

```
ibmcloud kp import-token nonce-encrypt -i $INSTANCE_ID
```
{:pre}

```sh
$ ibmcloud kp import-token nonce-encrypt -i $INSTANCE_ID -k $KEY_MATERIAL -n $NONCE
SUCCESS

Encrypted Nonce                            IV
sw2Bdq2NT9yEjkf6H+4JHtDhciZMJKhxoH9jeA==   OLro3ZmEbaFTCpT+
```
{:screen}

### Required parameters
{: #nonce-encrypt-req-params}

<dl>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #nonce-encrypt-opt-params}

<dl>
    <dt><code>-k, --key</code></dt>
        <dd>The base64 encoded key material that you want to store and manage in the service.</dd>
    <dt><code>-n, --nonce</code></dt>
        <dd>The nonce that was distributed by {{site.data.keyword.keymanagementserviceshort}}. The value is base64 encoded. To retrieve a nonce, use <code>ibmcloud kp import-token show</code>.</dd>
</dl>

## kp import-token key-encrypt
{: #kp-import-token-key-encrypt}

Encrypt the key material that you want to import to {{site.data.keyword.keymanagementserviceshort}} by using the public key that's associated with your service instance. Then, provide the retrieved encrypted key when you run `ibmcloud kp key create` to import the key to the service.

```
ibmcloud kp import-token key-encrypt -i $INSTANCE_ID
```
{:pre}

```sh
$ ibmcloud kp import-token key-encrypt -i $INSTANCE_ID -k $KEY_MATERIAL -p $PUBLIC_KEY
SUCCESS

Encrypted Key
Ic6OH8dhjnqoMzBvItxS3wlyiziIs2C9U+...
```
{:screen}

### Required parameters
{: #key-encrypt-req-params}

<dl>
    <dt><code>-i, --instance-ID</code></dt>
        <dd>The {{site.data.keyword.cloud_notm}} instance ID that identifies your {{site.data.keyword.keymanagementserviceshort}} service instance.</dd>
</dl>

### Optional parameters
{: #key-encrypt-opt-params}

<dl>
    <dt><code>-k, --key</code></dt>
        <dd>The base64 encoded key material that you want to store and manage in the service.</dd>
    <dt><code>-p, --pubkey</code></dt>
        <dd>The base64 encoded public encryption key that was distributed by Key Protect. To retrieve a public key, use <code>ibmcloud kp import-token show</code>.</dd>
</dl>